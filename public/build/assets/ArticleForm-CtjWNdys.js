import{r as i,j as a}from"./app-BK8BXCof.js";import{S as u}from"./react-select.esm-CCSqlFmV.js";import{E as c}from"./Editor-CvkC8Qz1.js";import{h as A,u as D}from"./helper-BQns0gKX.js";import{u as w}from"./useQueryParams-DLrGtwV6.js";import{g as C,a as F,c as S}from"./apiEndpoints-DYi1yudi.js";import{d as E}from"./index-Bvv0SIWi.js";import{g as T}from"./apis-CbdJYn5R.js";import"./index-Br9QVruO.js";const O=()=>{const{getQueryParam:d}=w(),[l,s]=i.useState({title:"",doi:"",journal:[],articleType:[],authorAffiliation:"",author:"",createdDate:"",publishedDate:"",pdfFile:[],abstract:"",edit:isNaN(Number(d("edit")))?null:Number(d("edit"))}),[U,m]=i.useState(!1),f=async()=>{try{const e=await T();if(e!=null&&e.success&&Array.isArray(e.data)){const t=e.data.map(r=>({label:r.title,value:r.id}));g(t)}}catch(e){console.error("Failed to load article types:",e)}},b=async e=>{e.preventDefault(),m(!0);try{const t=await window.apiRequest(S,"POST",l);t!=null&&t.success?(s({...t.data}),E.Inertia.visit("/table?table=articles")):console.warn("Unexpected response:",t)}catch(t){console.error("Error submitting form:",t)}finally{m(!1)}},o=e=>{s({...l,[e.target.name]:e.target.value})},n=(e,t)=>{s(r=>({...r,[e]:t}))},h=(e,t)=>{s({...l,[t]:e})},p=async e=>{try{const t=await A(e,D),{name:r}=e.target;s(y=>({...y,[r]:t}))}catch(t){console.error("Upload failed:",t.message)}},[x,j]=i.useState([]),[N,g]=i.useState([]);function v(){window.apiRequest(`${F}`).then(e=>{e!=null&&e.success&&j(e.data)})}return i.useEffect(()=>{v(),f(),l.edit&&window.apiRequest(`${C}/${l.edit}`).then(e=>{if(e!=null&&e.success){const t=e.data;s({...l,title:t.title,doi:t.doi,journal:t.journal,articleType:t.article_type,authorAffiliation:t.authorAffiliation,author:t.author,createdDate:t.createdDate,publishedDate:t.publishedDate,pdfFile:t.pdf_file,abstract:t.abstract,edit:t.id})}else console.warn("Unexpected response:",e),alert("Something went wrong!")}).catch(e=>{console.error("Error fetching journal:",e)})},[]),a.jsx("div",{className:"mx-auto",style:{height:"96vh",width:"95vw"},children:a.jsxs("div",{className:"p-4",children:[a.jsx("h2",{className:"text-center mb-4",children:"Create Article"}),a.jsxs("form",{onSubmit:b,className:"row g-3",children:[a.jsxs("div",{className:"col-md-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Title"}),a.jsx("input",{type:"text",name:"title",value:l.title,onChange:o,className:"form-control"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"DOI"}),a.jsx("input",{type:"text",name:"doi",value:l.doi,onChange:o,className:"form-control"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Author Affiliation"}),a.jsx(c,{height:500,name:"authorAffiliation",value:l.authorAffiliation,onChange:e=>n("authorAffiliation",e)},"authorAffiliationEditor")]})]}),a.jsxs("div",{className:"col-md-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Created Date"}),a.jsx("input",{type:"date",name:"createdDate",value:l.createdDate,onChange:o,className:"form-control"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Published Date"}),a.jsx("input",{type:"date",name:"publishedDate",value:l.publishedDate,onChange:o,className:"form-control"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Author"}),a.jsx(c,{height:400,name:"author",value:l.author,onChange:e=>n("author",e)},"authorEditor")]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Upload PDF"}),a.jsx("input",{type:"file",name:"pdfFile",onChange:p,className:"form-control"}),l.pdfFile&&a.jsx("a",{href:l.pdfFile.filePath,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline mt-3 inline-block",children:l.pdfFile.filename})]})]}),a.jsxs("div",{className:"col-md-4",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Abstract"}),a.jsx(c,{height:450,name:"abstract",value:l.abstract,onChange:e=>n("abstract",e)},"abstractEditor")]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Journal"}),a.jsx(u,{options:x,value:l.journal,onChange:e=>h(e,"journal"),className:"form-select"})]}),a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"form-label",children:"Article Type"}),a.jsx(u,{options:N,value:l.articleType,onChange:e=>h(e,"articleType"),className:"form-select"})]})]}),a.jsx("div",{className:"col-12 text-end",children:a.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",children:"Save Article"})})]})]})})},P=()=>a.jsx(O,{}),z=()=>a.jsx(P,{});export{z as default};
