import{j as e,r as b}from"./app-CuAWbn3K.js";import{u as j}from"./useQueryParams-DFCxT9ka.js";import{h as f,u as E}from"./helper-CUGt8oWz.js";import{e as N,f as w,h as v}from"./apiEndpoints-ooPQ9U6Q.js";import{d as y}from"./index-CFDgAmWI.js";import{S as m}from"./react-select.esm-HratpCyF.js";import{E as x}from"./Editor-SGYiBW6y.js";/* empty css            */import"./index-D9X9ttbZ.js";function C({formData:t,handleChange:r,handleChangeEditor:n,handleChangeEditor1:u,handleSelectChange:c,handleFileChange:p,handleSubmit:h}){return e.jsxs("div",{className:"w-4/5 mx-auto p-6 border rounded shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Journal Form"}),e.jsxs("form",{onSubmit:h,className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border-r pr-6 space-y-4",children:[e.jsx("label",{children:"Title:"}),e.jsx("input",{type:"text",name:"title",value:t.title,onChange:r,className:"w-full border p-2"}),e.jsx("label",{children:"Short Name:"}),e.jsx("input",{type:"text",name:"shortname",value:t.shortname,onChange:r,className:"w-full border p-2"}),e.jsx("label",{children:"Publication Charges:"}),e.jsx(x,{name:"publicationCharges",value:t.publicationCharges,onChange:n}),e.jsx("label",{children:"ISSNNO:"}),e.jsx("input",{type:"text",name:"issno",value:t.issno,onChange:r,className:"w-full border p-2"})]}),e.jsxs("div",{className:"pl-6 space-y-4",children:[e.jsx("label",{children:"Description:"}),e.jsx(x,{name:"description",value:t.description,onChange:u}),e.jsx("label",{children:"Editor in Chief:"}),e.jsx(m,{options:t.chiefeditorOptions,value:t.chiefEditor,onChange:o=>c(o,"chiefEditor"),className:"w-full border p-2"}),e.jsx("label",{children:"Editors:"}),e.jsx(m,{options:t.editorOptions,value:t.editors,onChange:o=>c(o,"editors"),isMulti:!0,className:"w-full border p-2"}),e.jsx("label",{children:"Associate Editors:"}),e.jsx(m,{options:t.associateEditorOptions,value:t.associateEditors,onChange:o=>c(o,"associateEditors"),isMulti:!0,className:"w-full border p-2"})]}),e.jsxs("div",{className:"col-span-2 space-y-4",children:[e.jsx("label",{children:"Classification:"}),e.jsx("textarea",{name:"classification",value:t.classification,onChange:r,className:"w-full border p-2"})]}),e.jsx("div",{className:"col-span-2 grid grid-cols-3 gap-4",children:["photoOurJournal","photoBanner","photo"].map(o=>{var d;return e.jsxs("div",{children:[e.jsx("label",{children:o.replace(/photo/,"Photo ")}),e.jsx("input",{type:"file",name:o,onChange:p,className:"w-full border p-2"}),t[o]&&e.jsx("img",{src:typeof t[o]=="string"?t[o]:(d=t[o])==null?void 0:d.filePath,alt:"Preview",className:"w-32 h-32 object-cover border mt-3"})]},o)})}),e.jsx("div",{className:"col-span-2 flex justify-end",children:e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded",disabled:t.isSubmitting,children:t.isSubmitting?"Submitting...":"Submit"})})]})]})}function S(){const{getQueryParam:t}=j(),[r,n]=b.useState({title:"",shortname:"",publicationCharges:"",issno:"",description:"",chiefEditor:[],editors:[],associateEditors:[],classification:"",photoOurJournal:null,photoBanner:null,photo:null,isSubmitting:!1,edit:isNaN(Number(t("edit")))?null:Number(t("edit")),chiefeditorOptions:[],editorOptions:[],associateEditorOptions:[]}),u=a=>{const{name:s,value:i}=a.target;n(l=>({...l,[s]:i}))},c=(a,s="publicationCharges")=>{n(i=>({...i,[s]:a}))},p=(a,s="description")=>{n(i=>({...i,[s]:a}))},h=(a,s)=>{n(i=>({...i,[s]:a}))},o=async a=>{try{const s=await f(a,E),{name:i}=a.target;n(l=>({...l,[i]:s}))}catch(s){console.error("Upload failed:",s.message)}};b.useEffect(()=>{async function a(){try{const s=await window.apiRequest(N);if(s!=null&&s.success&&n(i=>({...i,chiefeditorOptions:s.data[1],editorOptions:s.data[2],associateEditorOptions:s.data[3]})),r.edit){const i=await window.apiRequest(`${w}/${r.edit}`);if(i!=null&&i.success){const l=i.data;n(g=>({...g,...l,chiefEditor:l.linked_table[1][0]||[],editors:l.linked_table[2]||[],associateEditors:l.linked_table[3]||[]}))}}}catch(s){console.error("Error fetching data:",s)}}a()},[r.edit]);const d=async a=>{if(a.preventDefault(),!r.isSubmitting){n(s=>({...s,isSubmitting:!0}));try{if(!(await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Action failed");y.Inertia.visit("/table?table=journals")}catch(s){console.error("Error submitting form:",s)}}};return e.jsx(C,{formData:r,handleChange:u,handleSelectChange:h,handleFileChange:o,handleSubmit:d,handleChangeEditor:c,handleChangeEditor1:p})}const q=()=>e.jsx(S,{});export{q as default};
