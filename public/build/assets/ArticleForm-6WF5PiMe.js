import{r as i,j as e}from"./app-D--eIwP2.js";import{S as f,h as v,u as y}from"./helper-DD_cLoxO.js";import{E as c}from"./Editor-CBHf4NBa.js";import{u as D,g as A,a as w,c as C,d as F}from"./useQueryParams-Bih7gm38.js";import"./index-Bw8KZS7D.js";const S=()=>{const{getQueryParam:d}=D(),[l,s]=i.useState({title:"",doi:"",journal:[],articleType:[],authorAffiliation:"",author:"",createdDate:"",publishedDate:"",pdfFile:[],abstract:"",edit:isNaN(Number(d("edit")))?null:Number(d("edit"))}),[T,m]=i.useState(!1),b=async a=>{a.preventDefault(),m(!0);try{const t=await window.apiRequest(C,"POST",l);t!=null&&t.success?(s({...t.data}),F.Inertia.visit("/table?table=articles")):console.warn("Unexpected response:",t)}catch(t){console.error("Error submitting form:",t)}finally{m(!1)}},r=a=>{s({...l,[a.target.name]:a.target.value})},n=(a,t)=>{s(o=>({...o,[a]:t}))},h=(a,t)=>{s({...l,[t]:a})},x=async a=>{try{const t=await v(a,y),{name:o}=a.target;s(g=>({...g,[o]:t}))}catch(t){console.error("Upload failed:",t.message)}},[j,p]=i.useState([]),u=[{value:0,label:"select"},{value:1,label:"Research"},{value:2,label:"Review"}];function N(){window.apiRequest(`${w}`).then(a=>{a!=null&&a.success&&p(a.data)})}return i.useEffect(()=>{N(),l.edit&&window.apiRequest(`${A}/${l.edit}`).then(a=>{if(a!=null&&a.success){const t=a.data;s({...l,title:t.title,doi:t.doi,journal:t.journal,articleType:u[t.articleType]??[],authorAffiliation:t.authorAffiliation,author:t.author,createdDate:t.createdDate,publishedDate:t.publishedDate,pdfFile:t.pdf_file,abstract:t.abstract,edit:t.id})}else console.warn("Unexpected response:",a),alert("Something went wrong!")}).catch(a=>{console.error("Error fetching journal:",a)})},[]),e.jsx("div",{className:"mx-auto",style:{height:"96vh",width:"95vw"},children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-center mb-4",children:"Create Article"}),e.jsxs("form",{onSubmit:b,className:"row g-3",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:l.title,onChange:r,className:"form-control"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"DOI"}),e.jsx("input",{type:"text",name:"doi",value:l.doi,onChange:r,className:"form-control"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Author Affiliation"}),e.jsx(c,{height:500,name:"authorAffiliation",value:l.authorAffiliation,onChange:a=>n("authorAffiliation",a)},"authorAffiliationEditor")]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Created Date"}),e.jsx("input",{type:"date",name:"createdDate",value:l.createdDate,onChange:r,className:"form-control"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Published Date"}),e.jsx("input",{type:"date",name:"publishedDate",value:l.publishedDate,onChange:r,className:"form-control"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Author"}),e.jsx(c,{height:400,name:"author",value:l.author,onChange:a=>n("author",a)},"authorEditor")]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Upload PDF"}),e.jsx("input",{type:"file",name:"pdfFile",onChange:x,className:"form-control"}),l.pdfFile&&e.jsx("a",{href:l.pdfFile.filePath,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline mt-3 inline-block",children:l.pdfFile.filename})]})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Abstract"}),e.jsx(c,{height:450,name:"abstract",value:l.abstract,onChange:a=>n("abstract",a)},"abstractEditor")]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Journal"}),e.jsx(f,{options:j,value:l.journal,onChange:a=>h(a,"journal"),className:"form-select"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Article Type"}),e.jsx(f,{options:u,value:l.articleType,onChange:a=>h(a,"articleType"),className:"form-select"})]})]}),e.jsx("div",{className:"col-12 text-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",children:"Save Article"})})]})]})})},E=()=>e.jsx(S,{}),q=()=>e.jsx(E,{});export{q as default};
